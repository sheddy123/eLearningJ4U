@using eLearningLMS.Extensions
@model IEnumerable<eLearningLMS.Models.Enrollment>
@{
                /**/

                /**/

                ViewBag.Title = "Index";
                Layout = "~/Views/Shared/_DashboardeLearning.cshtml";

}

@section scripts{
        <script>
            $(document).ready(function () {
                $('.btn-bootstrap-dialog').click(function () {
                    var url = $(this).data('url');
                    var title = $(this).attr('title');
                    $.get(url, function (data) {
                        $('#bootstrapDialog').html(data);
                        $('#bootstrapDialog').modal('show');
                        // alert(title)
                        $('#ModalPopUp').find('#myModalLabel').html($(this).attr("title"));
                    });
                });
            });
        </script>
        <script>

            $(function () {
                $('a#submit_link').click(function () {
                    $('form#fooForm').submit();
                });
            });
        </script>

        <script>
            $(document).ready(function () {
                var table = $("#enrollments").DataTable();
                $("#enrollments").on("click", ".js-delete", function () {
                    var button = $(this);
                    $.ajax({
                        url: "/api/enrollments/" + button.attr("data-enrollments-id"),
                        method: "DELETE",
                        success: function () {
                            table.row(button.parents("tr")).remove().draw();
                        }
                    });
                });
            });
            
                    //$(document).ready(function () {
                    //    $("#enrollments").DataTable();
                    //    $("#enrollments").on("click", ".js-delete", function() {
                    //            var button = $(this);
                    //            bootbox.confirm("Are you sure you want to delete this enrollment?", function (result) {
                    //                if (result) {
                    //                    $.ajax({
                    //                        url: "/api/enrollments/" + button.attr("data-enrollments-id"),
                    //                        method: "DELETE",
                    //                        success: function () {
                    //                            DataTable.row(button.parents("tr")).remove().draw();
                    //                        }
                    //                    });
                    //                }
                    //            });
                    //});
        </script>
    }

@if (Request.IsAuthenticated && User.IsInRole("Student"))
{
    <!-- begin #sidebar -->
    <div id="sidebar" class="sidebar">
        <!-- begin sidebar scrollbar -->
        <div data-scrollbar="true" data-height="100%">
            <!-- begin sidebar user -->
            <ul class="nav">
                <li class="nav-profile">
                    <div class="image">
                        <a href="javascript:;">
                            <img src="@Url.Action("UserPhotos", "Home")" alt="User Image"
                                 style=" width: 40px; height: 40px;
                                " />
                        </a>

                    </div>
                    <div class="info">
                        @User.Identity.GetUserFirstName()
                        <span aria-label="Active now" style="background: rgb(66, 183, 42); border-radius: 50%; display: inline-block; height: 6px; width: 6px;"></span> <small>Student</small>
                    </div>
                </li>
            </ul>
            <!-- end sidebar user -->
            <!-- begin sidebar nav -->
            <ul class="nav">
                <li class="nav-header">Navigation</li>
                <li class="has-sub active">
                    <a href="javascript:;">
                        @*<b class="caret pull-right"></b>*@
                        <i class="fa fa-laptop"></i>
                        <span>Dashboard</span>
                    </a>
                    @*<ul class="sub-menu">
                <li class="active"><a href="index.html">Dashboard v1</a></li>
                <li><a href="index_v2.html">Dashboard v2</a></li>
            </ul>*@
                </li>
                <li class="has-sub">
                    <a href="~/Enrollments/Index">
                        <span class="badge pull-right">10</span>
                        <i class="fa fa-inbox"></i>
                        <span>Enrollments</span>
                    </a>
                </li>
                <li class="has-sub">
                    <a href="~/Support">
                        @*<b class="caret pull-right"></b>*@
                        <i class="fa fa-book"></i>
                        <span>Download Courses<span class="label label-theme m-l-5">NEW</span></span>
                    </a>
                </li>
                <li class="has-sub">
                    <a href="~/Home/QuizIndex">
                        @*<b class="caret pull-right"></b>*@
                        <i class="fa fa-pencil-square-o"></i>
                        <span>Attempt Quiz</span>
                    </a>
                </li>
                <li><a href="~/Home/Calendar"><i class="fa fa-calendar"></i> <span>Calendar</span></a></li>
                <li class="has-sub">
                    <a href="javascript:document.getElementById('logoutForm').submit()">
                        <b class="caret pull-right"></b>
                        <i class="fa fa-key"></i>
                        <span>Logout</span>
                    </a>
                </li>
                <li class="has-sub">
                    <a href="javascript:;">
                        <b class="caret pull-right"></b>
                        <i class="fa fa-cubes"></i>
                        <span>Version <span class="label label-theme m-l-5">NEW</span></span>
                    </a>
                    @*<ul class="sub-menu">
                <li><a href="javascript:;">HTML</a></li>
                <li><a href="../template_content_ajax/index.html">AJAX</a></li>
                <li><a href="../template_content_angularjs/index.html">ANGULAR JS</a></li>
                <li><a href="../template_content_angularjs2/index.html">ANGULAR JS 2 <i class="fa fa-paper-plane text-theme m-l-5"></i></a></li>
                <li><a href="../template_content_material/index.html">MATERIAL DESIGN</a></li>
            </ul>*@
                </li>

                <!-- begin sidebar minify button -->
                <li><a href="javascript:;" class="sidebar-minify-btn" data-click="sidebar-minify"><i class="fa fa-angle-double-left"></i></a></li>
                <!-- end sidebar minify button -->
            </ul>
            <!-- end sidebar nav -->
        </div>
        <!-- end sidebar scrollbar -->
    </div>
    <!-- begin #content -->
    <div id="content" class="content">
        <!-- begin breadcrumb -->
        <ol class="breadcrumb pull-right">
            <li><a href="javascript:;">Home</a></li>
            <li class="active">Enrollments</li>
            
        </ol>
        <!-- end breadcrumb -->
        <!-- begin page-header -->

        <!-- end page-header -->
        <!-- begin row -->
        <div class="row">
          
            <div class="col-md-10">
                <div class="panel panel-inverse">
                    <div class="panel-heading">
                        <div class="panel-heading-btn">
                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-repeat"></i></a>
                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                            <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>
                        </div>
                        <h4 class="panel-title">@User.Identity.GetUserFirstName()'s Enrollments</h4>
                    </div>
                    <div class="panel-body">
                        @if (ViewBag.CheckId == null)
                        {
                            <div class="alert alert-success fade in">
                                <button type="button" class="close" data-dismiss="alert">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                                Please enter your Personal Details
                            </div>
                            @*@ViewBag.Message;*@
                            <div class="panel panel-default panel-table">
                                <div class="panel-heading">
                                    <div class="row">
                                        <div class="col col-xs-6">
                                            <h3 class="panel-title btn">Personal Details</h3>
                                        </div>
                                        <div class="col col-xs-6 text-right">
                                            <input type="button" class="btn-bootstrap-dialog btn btn-success pull-right" title="Add Student Detail" data-url="@Url.Action("StudentDetails", "Students", new { title = "Add Employee Detail" })" value="Create New" data-toggle="modal" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                        else
                        {
                            <table id="enrollments" class="table table-striped table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th>
                                            S/N
                                        </th>
                                        <th>
                                            @Html.DisplayNameFor(model => model.Course.CourseCode)
                                        </th>
                                        <th>
                                            @Html.DisplayNameFor(model => model.Course.Title)
                                        </th>
                                        <th>
                                            @Html.DisplayNameFor(model => model.Course.Credits)
                                        </th>
                                        <th></th>
                                    </tr>
                                </thead>
                                @{ int cnt = 0;}
                                @if (Model == null)
                                {
                                }
                                else
                                {
                                    <tbody>
                                        @foreach (var item in Model)
                                        {
                                            <tr>
                                                <td>
                                                    @{
                                                        cnt++;
                                                    }
                                                    @cnt
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.Course.CourseCode)
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.Course.Title)
                                                </td>
                                                <td>
                                                    @Html.DisplayFor(modelItem => item.Course.Credits)
                                                </td>
                                                <td>
                                                    <button data-enrollments-id="@item.EnrollmentID" class="btn-link js-delete">Delete</button>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                }
                            </table>




                            <form id="fooForm" class="form-inline" action="/Enrollments/Create" method="post">
                                @Html.AntiForgeryToken()

                                <div class="form-horizontal">
                                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="CourseID">Courses</label>
                                        <div class="col-md-9">
                                            @Html.DropDownList("CourseID", null, htmlAttributes: new { @class = "form-control" })
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-md-offset-5 col-md-4">
                                            <a href="#" id="submit_link" class="btn btn-primary">Save</a>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        }
                        <div class="modal fade" id="bootstrapDialog" tabindex="-1" role="dialog" aria-labelledby="myModal-label" aria-hidden="true"></div>


                    </div>
                </div>
            </div>
            <!-- end col-10 -->
        </div>
        <!-- end row -->
    </div>
    <!-- end #content -->
}
