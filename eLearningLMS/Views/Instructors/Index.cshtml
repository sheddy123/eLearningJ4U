@model eLearningLMS.ViewModels.InstructorIndexData
@using eLearningLMS.Extensions
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_DashboardeLearning.cshtml";
}
@section scripts{
    <script>
        $(document).ready(function () {
            var table = $("#enrollments").DataTable();
            $("#enrollments").on("click", ".js-delete", function () {
                var button = $(this);
                $.ajax({
                    url: "/api/enrollments/" + button.attr("data-enrollments-id"),
                    method: "DELETE",
                    success: function () {
                        table.row(button.parents("tr")).remove().draw();
                    }
                });
            });
        });
    </script>
}


@if (Request.IsAuthenticated && User.IsInRole("Instructor"))
{
    <!-- begin #sidebar -->
    <div id="sidebar" class="sidebar">
        <!-- begin sidebar scrollbar -->
        <div data-scrollbar="true" data-height="100%">
            <!-- begin sidebar user -->
            <ul class="nav">
                <li class="nav-profile">
                    <div class="image">
                        <a href="javascript:;">
                            <img src="@Url.Action("UserPhotos", "Home")" alt="User Image"
                                 style=" width: 40px; height: 40px;
                                " />
                        </a>

                    </div>
                    <div class="info">
                        @User.Identity.GetUserFirstName()
                        <span aria-label="Active now" style="background: rgb(66, 183, 42); border-radius: 50%; display: inline-block; height: 6px; width: 6px;"></span><small>Instructor</small>
                    </div>
                </li>
            </ul>
            <!-- end sidebar user -->
            <!-- begin sidebar nav -->
            <ul class="nav">
                <li class="nav-header">Navigation</li>
                <li class="has-sub active">
                    <a href="javascript:;">
                        @*<b class="caret pull-right"></b>*@
                        <i class="fa fa-laptop"></i>
                        <span>Dashboard</span>
                    </a>
                    @*<ul class="sub-menu">
                <li class="active"><a href="index.html">Dashboard v1</a></li>
                <li><a href="index_v2.html">Dashboard v2</a></li>
            </ul>*@
                </li>
                <li class="has-sub">
                    <a href="~/Instructors/Index">
                        <span class="badge pull-right">10</span>
                        <i class="fa fa-user"></i>
                        <span>Instructor</span>
                    </a>
                </li>
                <li class="has-sub">
                    <a href="~/Support/UploadFile">

                        <i class="fa fa-upload"></i>
                        <span>Upload Course</span>
                    </a>
                </li>
                <li class="has-sub">
                    <a href="~/Home/Email">
                        <i class="fa fa-inbox"></i>
                        <span>Send Email</span>
                    </a>
                </li>
                <li><a href="~/Home/Calendar"><i class="fa fa-calendar"></i> <span>Calendar</span></a></li>

                <li class="has-sub">
                    <a href="~/Account/Login">
                        @*<b class="caret pull-right"></b>*@
                        <i class="fa fa-key"></i>
                        <span>Login</span>
                    </a>

                </li>
                <li class="has-sub">
                    <a href="javascript:;">
                        @*<b class="caret pull-right"></b>*@
                        <i class="fa fa-cubes"></i>
                        <span>Version <span class="label label-theme m-l-5">NEW</span></span>
                    </a>

                </li>

                <!-- begin sidebar minify button -->
                <li><a href="javascript:;" class="sidebar-minify-btn" data-click="sidebar-minify"><i class="fa fa-angle-double-left"></i></a></li>
                <!-- end sidebar minify button -->
            </ul>
            <!-- end sidebar nav -->
        </div>
        <!-- end sidebar scrollbar -->
    </div>
    <div class="sidebar-bg"></div>
    <!-- end #sidebar -->

    if (Model.Instructors != null)
    {
        <!-- begin #content -->
        <div id="content" class="content">
            <!-- begin breadcrumb -->
            <ol class="breadcrumb pull-right">
                <li><a href="javascript:;">Home</a></li>
                <li class="active">Instructors</li>
            </ol>
            <!-- end breadcrumb -->
            <!-- begin page-header -->
            <h1 class="page-header">Courses</h1>
            <!-- end page-header -->
            <!-- begin row -->
            <div class="row">

                <!-- begin col-10 -->
                <div class="col-md-10">
                    <!-- begin panel -->
                    <div class="panel panel-inverse">
                        <div class="panel-heading">
                            <div class="panel-heading-btn">
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-repeat"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>
                            </div>
                            <h4 class="panel-title">Instructors</h4>
                        </div>
                        <div class="alert alert-success fade in">
                            <button type="button" class="close" data-dismiss="alert">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            Assign course to Instructor
                        </div>
                        <div class="panel-body">
                            <p>
                                <a href="~/Instructors/Create" class="btn btn-primary m-r-5">Create New Course</a>
                                @*@Html.ActionLink("Create New", "Create", new { @class = "btn btn-primary m-r-5" })*@
                            </p>
                            <table id="data-table" class="table table-striped table-bordered nowrap" width="100%">
                                <tr>
                                    <th>S/N</th>
                                    <th>
                                        LastName
                                    </th>
                                    <th>
                                        FirstName
                                    </th>
                                    <th>
                                        HireDate
                                    </th>
                                    @*<th>
                                            Department
                                        </th>*@
                                    <th>
                                        Office
                                    </th>
                                    <th>Courses Taught</th>
                                    <th></th>
                                </tr>
                                @{ int cnt = 0;}
                                @foreach (var item in Model.Instructors)
                                {
                                    <tr>
                                        <td>@{cnt++;} @cnt</td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.LastName)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.FirstName)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.HireDate)
                                        </td>
                                        @*<td>
                                                @Html.DisplayFor(modelItem => item.Department.Name)
                                            </td>*@
                                        <td>
                                            @if (item.OfficeAssignment != null)
                                            {@item.OfficeAssignment.Location}
                                        </td>
                                        <td>
                                            @{
                                                foreach (var course in item.Courses)
                                                {
                                                    @course.CourseCode @: @course.Title <br />
                                                }
                                            }
                                        </td>
                                        <td>
                                            @Html.ActionLink("Select", "Index", new { id = item.id }) |
                                            @Html.ActionLink("Edit", "Edit", new { id = item.id }) |
                                            @Html.ActionLink("Details", "Details", new { id = item.id }) |
                                            @*@Html.ActionLink("Delete", "Delete", new { id = item.id })*@
                                        </td>
                                    </tr>
                                }
                            </table>
                        </div>
                    </div>
                    <!-- end panel -->
                </div>
                <!-- end col-10 -->
            </div>
            <!-- end row -->
        </div>
        <!-- end #content -->
    }
    if (Model.Courses != null)
    {

        <!-- begin #content -->
        <div id="content" class="content">
            <!-- begin row -->
            <div class="row">

                <!-- begin col-10 -->
                <div class="col-md-10">
                    <!-- begin panel -->
                    <div class="panel panel-inverse">
                        <div class="panel-heading">
                            <div class="panel-heading-btn">
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-repeat"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>
                            </div>
                            <h4 class="panel-title">Instructors</h4>
                        </div>
                        <div class="alert alert-success fade in">
                            <button type="button" class="close" data-dismiss="alert">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            Instructor's courses
                        </div>
                        <div class="panel-body">
                            <h3>Courses Taught by Selected Instructor</h3>
                            <table id="data-table" class="table table-striped table-bordered nowrap" width="100%">
                                <tr>
                                    <th></th>
                                    <th>Number</th>
                                    <th>Title</th>
                                    <th>Department</th>
                                </tr>
                                @foreach (var item in Model.Courses)
                                {
                                    string selectedRow = "";
                                    if (item.Id == ViewBag.CourseID)
                                    {
                                        selectedRow = "success";
                                    }
                                    <tr class="@selectedRow">
                                        <td>
                                            @Html.ActionLink("Select", "Index", new { courseID = item.Id })
                                        </td>
                                        <td>
                                            @item.Id
                                        </td>
                                        <td>
                                            @item.Title
                                        </td>
                                        <td>
                                            @item.Department.Name
                                        </td>
                                    </tr>
                                }
                            </table>
                        </div>
                    </div>
                    <!-- end panel -->
                </div>
                <!-- end col-10 -->
            </div>
            <!-- end row -->
        </div>
        <!-- end #content -->
    }

    if (Model.Enrollments != null)
    {

        <!-- begin #content -->
        <div id="content" class="content">
            <!-- begin row -->
            <div class="row">

                <!-- begin col-10 -->
                <div class="col-md-10">
                    <!-- begin panel -->
                    <div class="panel panel-inverse">
                        <div class="panel-heading">
                            <div class="panel-heading-btn">
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-repeat"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>
                            </div>
                            <h4 class="panel-title">Instructors</h4>
                        </div>
                        <div class="alert alert-success fade in">
                            <button type="button" class="close" data-dismiss="alert">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            Enrolled Students
                        </div>
                        <div class="panel-body">
                            <h3>
                                Students Enrolled in Selected Course
                            </h3>
                            <table id="data-table" class="table table-striped table-bordered nowrap" width="100%">
                                <tr>
                                    <th>Name</th>
                                    <th>Grade</th>
                                </tr>
                                @foreach (var item in Model.Enrollments)
                                {
                                    <tr>
                                        <td>
                                            @item.Student.FullName
                                        </td>
                                        <td>
                                            @*@Html.DisplayFor(modelItem => item.Grade.GradePoint)*@
                                        </td>
                                    </tr>
                                }
                            </table>
                        </div>
                    </div>
                    <!-- end panel -->
                </div>
                <!-- end col-10 -->
            </div>
            <!-- end row -->
        </div>
        <!-- end #content -->
    }
}